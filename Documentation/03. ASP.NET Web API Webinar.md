![Logo](https://raw.github.com/JohannesHoppe/DeveloperMediaDemo/master/Documentation/images/developer_media_logo.jpg)

# ASP.NET Web API - Documentation

##### Table of Contents  
1. [Introduction](#introduction)
2. [Preparing with a simple model](#model)
3. [Requesting data with jQuery](#jQuery)

6. [More](#more)


<a name="introduction"/>
## 1. Introduction

The last two Webinars concentrated on client-side JavaScript. Let's review another important part of a modern website: the communication between client and server. It should be lightweight (no SOAP) and standard conform (REStful). On client-side we are already well equipped with jQuery and Knockout. On the server side we have an ASP.NET MVC 4 website that serves more or less static HTML content. Of course, we could use ASP.NET MVC to send and receive JSON data, but Microsoft offers a dedicated API that offers additional features such as a cleaner code, content-negotiation or improved routing. The bad news for WCF-enthusiast: all WCF-bits were removed. The god news for all ASP.NET guys: many ASP.NET MVC knowledge can be still required.    

 
<a name="model"/>
## 2. Preparing a simple model

We will use again a very simple model. It is a single C# class that represents a sticky post. It can have categories, which are just plain strings for simplicity.  

```csharp
public class Note
{
    public Note()
    {
        Categories = new List<string>();
    }

    public int Id { get; set; }

    public string Title { get; set; }

    public string Message { get; set; }

    public DateTime Added { get; set; }

    public IEnumerable<string> Categories { get; set; }
}
```

We will use this model to show a editable list of sticky notes:

![Screenshot](https://raw.github.com/JohannesHoppe/DeveloperMediaDemo/master/Documentation/images/03_1_screenshot.png) 

Letâ€™s assume that we have created a new project from the installed Visual Studio 2012 templates. (ASP.NET MVC 4 Web Application > Web API) This template has all the required Nuget packages included, ships with some tweaks in the web.config and contains the required registration of a default Web API route. These steps can be added to any existing ASP.NET project, too. The only hard dependency is the targeted version of the .NET framework (version 4.0 or later).
> In contrast to other technologies (e.g. the WCF - Windows Communication Foundation) the ASP.NET Web API is built with respect to the **"Convention Over Configuration"** principle.

Without any further configuration-ceremony we can just add a class to the project to offer one or more notes as a resource. (a resource is a source of specific information in a RESTful architecture) By convention the class must inherit from System.Web.Http.ApiController and must end with the word "Controller". This naming convention is well-known in the ASP.NET MVC world, too. The file can be located everywhere in the project (it's loaded via reflection), but it is a good start to add it in the namespace & folder "Controllers". 

```csharp
public class NoteController : ApiController
{
}
```

This resource will be available under to URL **"/api/note"** as specified in the default route:

```csharp
config.Routes.MapHttpRoute(
    name: "DefaultApi",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional }
);
```

The conventions continue with the naming of the methods. To respond to a HTTP GET request, the method should start with the prefix "Get". Since the id was marked as optional, we can add two methods: one for a request without an ID in the URL and one for the optional id (eg. **"api/note/222"**).

```csharp
public class NoteController : ApiController
{
    public IEnumerable<Note> GetAll()
    {
        return NoteRepository.ReadAll();
    }

    public Note Get(int id)
    {
        return NoteRepository.Read(id);
    }
}
``` 
      
The exact method name does not matter, just the prefix and the parameter signature is important. 

<a name="jQuery"/>
## 3. Requesting data with jQuery

The ASP.NET Web API was clearly made for serving AJAX driven websites. A very easy-to use AJAX api is provided by jQuery. Our simple Web API can be consumed with the following lines of code:  

```javascript
$.get('/api/note').done(function (xhr) {
  console.log("AJAX Result: ", xhr)
});
```




<a name="more"/>
## 6. More 

This was a very rought overview. There are severel details to discover.
You should start by downloading the sources of the Single Page app.

&nbsp;&nbsp; __[&raquo; Download Demo-Code (.zip)](http://dl.bintray.com/johanneshoppe/DeveloperMediaDemo/DeveloperMediaWebinar_Knockout_Teil2_SinglePage.zip?direct)__


<hr>
_&copy; 2013, Johannes Hoppe_